<div class="card-body border-0">
  <h5 class="fw-bold border-bottom pb-2 mb-3">Coberturas y Límites</h5>
  <div class="table-like">
    <div class="thead">
      <div class="th th-cob">Cobertura</div>
      <div class="th th-montos">Montos Asegurados</div>
    </div>

    <div class="tbody">
      @let defs = definitions();
      @let vIdxs = visibleTierIdxs();

      @for (ctrl of coveragesFA().controls; track trackByIndex($index); let i = $index) {
        <div class="tr" [formGroup]="getGroup(i)">
          <div class="td td-cob">
            <div class="form-check m-0">
              <input
                class="form-check-input"
                type="checkbox"
                formControlName="selected"
                (change)="onToggle(i)"
                [id]="'cov_'+i"
              />
              <label class="form-check-label fw-semibold ms-2" [for]="'cov_'+i">
                {{ defs[i]?.name }}
              </label>
            </div>
          </div>

          <div class="td td-montos">
            @if (defs[i]?.kind === 'tier') {
              <div class="montos-grid">
                @for (t of (defs[i]?.tiers || []); track $index; let ti = $index) {
                  <div class="monto-celda" [class.disabled]="!vIdxs.includes(ti)">
                    @if (isSelected(i) && vIdxs.includes(ti)) {
                      {{ t | number:'1.0-2' }}
                    } @else {
                      —
                    }
                  </div>
                }
              </div>
            } @else {
              <div class="free-input">
                <input
                  type="number"
                  class="form-control text-center"
                  formControlName="amount"
                  [disabled]="!isSelected(i)"
                  min="0"
                  step="1"
                  placeholder="Monto"
                />
                <span class="suffix">{{ defs[i]?.suffix || '' }}</span>
              </div>
            }
          </div>
        </div>
      }
    </div>
  </div>
</div>